# GitHub Todo Webhook

This webhook was created with [webtask.io](http://webtask.io) as a webhook triggered by GitHub `push` events. It has been implemented on this repository. The payload POST URL is generated by an Auth0 webtask and provides parameters for a token and MongoDB database.

When triggered, the webhook checks the push payload for commits with messages containing a keyword: `todo`. If the `todo` keyword (case insensitive) is found, an object is inserted into a MongoDB database with the following properties:
 
 * `todo`: first occurrence of the `todo` keyword and subsequent message text
 * `timestamp`: commit timestamp
 * `author`: committer's name
 
If a commit's message does not contain a `todo` keyword, nothing is inserted into the database for that commit.

##How to install:

* If you do not already have a hosted MongoDB database, go to [mLab](https://mlab.com) and sign up for a free Sandbox account.
* Log into mLab and create a new database with a name of your choice (`git-push-todo`, for example).
* Click on the newly created database and under the Users tab, add a database user with a database username and password (do not check read-only)
* Go to [webtask.io/docs](http://webtask.io/docs) and log in.
* Go to [Webtask as a Webhook](https://webtask.io/docs/sample_github) while logged in and follow the instructions to copy the generated URL and install it as a webhook in the GitHub repository of your choice.
* Add an additional query parameter to the end of the generated URL in your GitHub webhook with your [mLab MongoDB URI](http://docs.mlab.com/connecting/#connect-string). This parameter will resemble the following: `&mongo=mongodb://[dbuser]:[dbpassword]@ds[####].mlab.com:[####]/[dbname]`
* Download [webtask.js](https://github.com/kmaida/webtask/blob/master/webtask.js) and save it to the root of your desired repository.
* When code is pushed to the repository, if pushed commit messages contain a `todo` keyword, the relevant message and time/author info will be inserted into your MongoDB in a collection called `todos` (there is no need to create this collection manually, the first insertion will create it).
* To view/redeliver webhook requests and responses, visit your repository's Settings > Webhooks & services.

##Dependencies:

* [Webtask CLI](https://webtask.io/cli) and [webtask.io account](https://webtask.io/docs/sample_github) to issue tokens and generate webtask URL 
* [smarthook.js](https://github.com/auth0/webtask-scripts/blob/master/github/smarthook.js)
* MongoDB database and connection URI
* A GitHub account and repository

##Potential Enhancements
* Save multiple `todo` database documents from a single commit message if the `todo` keyword appears more than once within the message
* Create an application that displays the collection in the browser
* Build a full To Do application with the collection that can update the database to change the status of or delete the todos
* ...etc